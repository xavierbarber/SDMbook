<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Spatial (areal &amp; geostatistical) SDM (Antonio y Maria) | Species-Distribution-Models</title>
  <meta name="description" content="Modelling Species Distribution book CRCPress" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Spatial (areal &amp; geostatistical) SDM (Antonio y Maria) | Species-Distribution-Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Modelling Species Distribution book CRCPress" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Spatial (areal &amp; geostatistical) SDM (Antonio y Maria) | Species-Distribution-Models" />
  
  <meta name="twitter:description" content="Modelling Species Distribution book CRCPress" />
  

<meta name="author" content="Barber, Conesa, Gomez-Rubio, Lopez-Quilez, Martinez-Minaya, Paradinas, Pennino" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data-data-type-and-maps-virgilio.html"/>
<link rel="next" href="preferential-sampling-in-the-context-of-sdm-david.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Species Distribution Models with R-INLA and INLABRU</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="species-distribution-models-a-recent-history-maría.html"><a href="species-distribution-models-a-recent-history-maría.html"><i class="fa fa-check"></i><b>1</b> Species Distribution Models: a recent history (María)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="species-distribution-models-a-recent-history-maría.html"><a href="species-distribution-models-a-recent-history-maría.html#the-unavoidable-globalization-of-knowledge"><i class="fa fa-check"></i><b>1.1</b> The Unavoidable Globalization of Knowledge</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bayesian-inference-integrated-nested-laplace-approximation-variational-bayes.-virgilio.html"><a href="bayesian-inference-integrated-nested-laplace-approximation-variational-bayes.-virgilio.html"><i class="fa fa-check"></i><b>2</b> Bayesian Inference: Integrated Nested Laplace Approximation &amp; Variational Bayes. (Virgilio)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian-inference-integrated-nested-laplace-approximation-variational-bayes.-virgilio.html"><a href="bayesian-inference-integrated-nested-laplace-approximation-variational-bayes.-virgilio.html#introduction-navigating-the-bayesian-landscape"><i class="fa fa-check"></i><b>2.1</b> Introduction: Navigating the Bayesian Landscape</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sdm-with-glm-and-gam-covariates-david.html"><a href="sdm-with-glm-and-gam-covariates-david.html"><i class="fa fa-check"></i><b>3</b> SDM with GLM and GAM (covariates) (David)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sdm-with-glm-and-gam-covariates-david.html"><a href="sdm-with-glm-and-gam-covariates-david.html#charting-the-ecological-landscape-with-glm-and-gam"><i class="fa fa-check"></i><b>3.1</b> Charting the Ecological Landscape with GLM and GAM</a></li>
<li class="chapter" data-level="3.2" data-path="sdm-with-glm-and-gam-covariates-david.html"><a href="sdm-with-glm-and-gam-covariates-david.html#glm"><i class="fa fa-check"></i><b>3.2</b> GLM</a></li>
<li class="chapter" data-level="3.3" data-path="sdm-with-glm-and-gam-covariates-david.html"><a href="sdm-with-glm-and-gam-covariates-david.html#gam"><i class="fa fa-check"></i><b>3.3</b> GAM</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-data-data-type-and-maps-virgilio.html"><a href="spatial-data-data-type-and-maps-virgilio.html"><i class="fa fa-check"></i><b>4</b> Spatial Data (data type and Maps) (Virgilio)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatial-data-data-type-and-maps-virgilio.html"><a href="spatial-data-data-type-and-maps-virgilio.html#mapping-the-confluence-of-spatial-data-and-species-distributions"><i class="fa fa-check"></i><b>4.1</b> Mapping the Confluence of Spatial Data and Species Distributions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><i class="fa fa-check"></i><b>5</b> Spatial (areal &amp; geostatistical) SDM (Antonio y Maria)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#navigating-the-spatial-landscape-in-species-distribution-models"><i class="fa fa-check"></i><b>5.1</b> Navigating the Spatial Landscape in Species Distribution Models</a></li>
<li class="chapter" data-level="5.2" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#geostatistical-species-distribution-model-with-r-inla"><i class="fa fa-check"></i><b>5.2</b> Geostatistical Species Distribution Model with R-INLA</a></li>
<li class="chapter" data-level="5.3" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#install-load-necessary-packages"><i class="fa fa-check"></i><b>5.3</b> Install &amp; Load Necessary Packages</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#generate-hypothetical-data"><i class="fa fa-check"></i><b>5.3.1</b> Generate Hypothetical Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#fit-a-geostatistical-model-using-r-inla"><i class="fa fa-check"></i><b>5.3.2</b> Fit a Geostatistical Model Using R-INLA</a></li>
<li class="chapter" data-level="5.3.3" data-path="spatial-areal-geostatistical-sdm-antonio-y-maria.html"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#plot-the-results"><i class="fa fa-check"></i><b>5.3.3</b> Plot the Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="preferential-sampling-in-the-context-of-sdm-david.html"><a href="preferential-sampling-in-the-context-of-sdm-david.html"><i class="fa fa-check"></i><b>6</b> Preferential Sampling in the context of SDM (David)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="preferential-sampling-in-the-context-of-sdm-david.html"><a href="preferential-sampling-in-the-context-of-sdm-david.html#unraveling-the-intricacies-of-preferential-sampling-in-species-distribution-models"><i class="fa fa-check"></i><b>6.1</b> Unraveling the Intricacies of Preferential Sampling in Species Distribution Models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="excess-of-zeroes-in-the-context-of-sdm-joaquin.html"><a href="excess-of-zeroes-in-the-context-of-sdm-joaquin.html"><i class="fa fa-check"></i><b>7</b> Excess of zeroes in the context of SDM (Joaquin)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="excess-of-zeroes-in-the-context-of-sdm-joaquin.html"><a href="excess-of-zeroes-in-the-context-of-sdm-joaquin.html#navigating-the-zeroes---challenges-and-opportunities-in-species-distribution-models"><i class="fa fa-check"></i><b>7.1</b> Navigating the Zeroes - Challenges and Opportunities in Species Distribution Models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="barriers-and-non-stationarity-models-davidjoaquin.html"><a href="barriers-and-non-stationarity-models-davidjoaquin.html"><i class="fa fa-check"></i><b>8</b> Barriers and non-stationarity models (David/Joaquin)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="barriers-and-non-stationarity-models-davidjoaquin.html"><a href="barriers-and-non-stationarity-models-davidjoaquin.html#beyond-uniformity-embracing-barriers-and-non-stationarity-in-sdms"><i class="fa fa-check"></i><b>8.1</b> Beyond Uniformity – Embracing Barriers and Non-Stationarity in SDMs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="misalignment-data-xavi.html"><a href="misalignment-data-xavi.html"><i class="fa fa-check"></i><b>9</b> Misalignment Data (Xavi)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="misalignment-data-xavi.html"><a href="misalignment-data-xavi.html#the-challenge-of-misalignment---navigating-data-inconsistencies-in-sdms"><i class="fa fa-check"></i><b>9.1</b> The Challenge of Misalignment - Navigating Data Inconsistencies in SDMs</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="presence-only-inlabru-xaviiosu.html"><a href="presence-only-inlabru-xaviiosu.html"><i class="fa fa-check"></i><b>10</b> Presence-only (INLABRU) (Xavi|Iosu)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="presence-only-inlabru-xaviiosu.html"><a href="presence-only-inlabru-xaviiosu.html#unraveling-the-enigma-of-presence-only-data-with-inlabru"><i class="fa fa-check"></i><b>10.1</b> Unraveling the Enigma of Presence-Only Data with INLABRU</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatio-temporal-species-distribution-iosu.html"><a href="spatio-temporal-species-distribution-iosu.html"><i class="fa fa-check"></i><b>11</b> Spatio-temporal species distribution (Iosu)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatio-temporal-species-distribution-iosu.html"><a href="spatio-temporal-species-distribution-iosu.html#navigating-the-dynamic-tapestry-of-spatio-temporal-species-distribution"><i class="fa fa-check"></i><b>11.1</b> Navigating the Dynamic Tapestry of Spatio-temporal Species Distribution</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="joint-species-distribution-models-xavi.html"><a href="joint-species-distribution-models-xavi.html"><i class="fa fa-check"></i><b>12</b> Joint Species Distribution models (Xavi)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="joint-species-distribution-models-xavi.html"><a href="joint-species-distribution-models-xavi.html#synergy-in-nature---delving-into-joint-species-distribution-models"><i class="fa fa-check"></i><b>12.1</b> Synergy in Nature - Delving into Joint Species Distribution Models</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-sources-of-information-dependent-independent-data-and-more-xavi.html"><a href="multiple-sources-of-information-dependent-independent-data-and-more-xavi.html"><i class="fa fa-check"></i><b>13</b> Multiple sources of information (dependent-independent data and more) (Xavi)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-sources-of-information-dependent-independent-data-and-more-xavi.html"><a href="multiple-sources-of-information-dependent-independent-data-and-more-xavi.html#confluence-of-data-streams---harnessing-multiple-sources-of-information-in-sdms"><i class="fa fa-check"></i><b>13.1</b> Confluence of Data Streams - Harnessing Multiple Sources of Information in SDMs</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="other-issues-downscaling-spatial-confounding-multiple-likelihoods-big-data-and-mapping-the-world-xavi-y-artistas-invitados.html"><a href="other-issues-downscaling-spatial-confounding-multiple-likelihoods-big-data-and-mapping-the-world-xavi-y-artistas-invitados.html"><i class="fa fa-check"></i><b>14</b> Other issues (downscaling, spatial confounding, multiple likelihoods, big data and mapping the world) (Xavi y artistas invitados)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="other-issues-downscaling-spatial-confounding-multiple-likelihoods-big-data-and-mapping-the-world-xavi-y-artistas-invitados.html"><a href="other-issues-downscaling-spatial-confounding-multiple-likelihoods-big-data-and-mapping-the-world-xavi-y-artistas-invitados.html#navigating-the-multifaceted-landscape-of-advanced-sdms"><i class="fa fa-check"></i><b>14.1</b> Navigating the Multifaceted Landscape of Advanced SDMs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">Modelling Species Distribution<br />
with R-INLA (and INLABRU?)<br />
</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-areal-geostatistical-sdm-antonio-y-maria" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Spatial (areal &amp; geostatistical) SDM (Antonio y Maria)<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#spatial-areal-geostatistical-sdm-antonio-y-maria" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Vale, y aquí Antonio nos dara una lección magistral de Geoestadística y Areal Data… no sé si algo de patrones puntuales y nos pondrá ejemplos de código para que los lectores puedan hacer sus primeras predicciones o su primer modelo de BYM…</p>
<p>¿cómo lo veis Antonio y María?</p>
<div id="navigating-the-spatial-landscape-in-species-distribution-models" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Navigating the Spatial Landscape in Species Distribution Models<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#navigating-the-spatial-landscape-in-species-distribution-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial structure – a fundamental component in understanding species distributions. In ecology, it’s long been acknowledged that observations in close proximity tend to be more similar than those farther apart, a concept encapsulated by Tobler’s First Law of Geography. Embracing this spatial dependence is crucial, especially when modeling species distributions, as overlooking it can lead to erroneous conclusions.</p>
<p>In this chapter titled “Spatial (areal &amp; geostatistical)”, we dive deep into the intricacies of areal and geostatistical data and their role in Species Distribution Models (SDMs). While areal data deals with aggregate information over spatial units (like polygons or regions), geostatistical data handles continuous variation across space, often relying on point-referenced data. Each has its unique challenges and opportunities when integrated into SDMs.</p>
<p>R-INLA, or Integrated Nested Laplace Approximations in R, emerges as a powerful tool in this spatial realm. Not only does it provide a robust framework for hierarchical modeling, but its capabilities in handling spatial structures – both areal and geostatistical – are unparalleled.</p>
<p>Throughout this chapter, we’ll explore the theoretical underpinnings of spatial data, understand their implications in SDMs, and master the techniques to effectively harness them using R-INLA. Step-by-step examples, real-world applications, and insightful visualizations will guide our journey, ensuring a comprehensive grasp of these spatial nuances.</p>
<p>As we chart this spatial course, our goal is to equip readers with the knowledge and skills to construct more accurate, refined, and ecologically meaningful species distribution models. So, let’s embark on this spatial exploration, where the synergy of space, species, and sophisticated modeling techniques unveils the patterns of life.</p>
</div>
<div id="geostatistical-species-distribution-model-with-r-inla" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Geostatistical Species Distribution Model with R-INLA<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#geostatistical-species-distribution-model-with-r-inla" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="install-load-necessary-packages" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Install &amp; Load Necessary Packages<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#install-load-necessary-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="generate-hypothetical-data" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Generate Hypothetical Data<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#generate-hypothetical-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-1" tabindex="-1"></a> <span class="co"># Create a spatial grid</span></span>
<span id="cb1-2"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-2" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length=</span><span class="dv">20</span>), <span class="at">y=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length=</span><span class="dv">20</span>) )</span>
<span id="cb1-3"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-3" tabindex="-1"></a><span class="fu">coordinates</span>(grid) <span class="ot">&lt;-</span> <span class="er">~</span>x<span class="sc">+</span>y</span>
<span id="cb1-4"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-4" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length=</span><span class="dv">20</span>)</span>
<span id="cb1-5"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-5" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length=</span><span class="dv">20</span>)</span>
<span id="cb1-6"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-6" tabindex="-1"></a><span class="co"># Simulate some environmental predictor</span></span>
<span id="cb1-7"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-7" tabindex="-1"></a>grid<span class="sc">$</span>env1 <span class="ot">&lt;-</span> <span class="fu">with</span>(grid, <span class="fu">sin</span>(x)<span class="sc">*</span><span class="fu">cos</span>(y))</span>
<span id="cb1-8"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-9" tabindex="-1"></a><span class="co"># Simulate presence-absence data with some spatial structure</span></span>
<span id="cb1-10"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-11"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-11" tabindex="-1"></a>grid<span class="sc">$</span>presence <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(grid), <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>grid<span class="sc">$</span>env1 <span class="sc">+</span> </span>
<span id="cb1-12"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb1-12" tabindex="-1"></a>                   <span class="fu">with</span>(grid, <span class="fu">rnorm</span>(<span class="at">n=</span><span class="fu">nrow</span>(grid), <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.5</span>))))</span></code></pre></div>
</div>
<div id="fit-a-geostatistical-model-using-r-inla" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Fit a Geostatistical Model Using R-INLA<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#fit-a-geostatistical-model-using-r-inla" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb2-1" tabindex="-1"></a><span class="co"># Define the formula</span></span>
<span id="cb2-2"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb2-2" tabindex="-1"></a>formula <span class="ot">&lt;-</span> presence <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> env1 <span class="sc">+</span> <span class="fu">f</span>(x, y, <span class="at">model=</span><span class="st">&quot;matern&quot;</span>, <span class="at">scale.model=</span><span class="st">&quot;range&quot;</span>)</span>
<span id="cb2-3"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb2-4" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb2-5"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb2-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">inla</span>(formula, <span class="at">data=</span>grid, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">control.predictor=</span><span class="fu">list</span>(<span class="at">compute=</span><span class="cn">TRUE</span>))</span></code></pre></div>
</div>
<div id="plot-the-results" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Plot the Results<a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#plot-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-1" tabindex="-1"></a><span class="co"># Plot the observed presences</span></span>
<span id="cb3-2"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-2" tabindex="-1"></a><span class="fu">spplot</span>(grid, <span class="st">&quot;presence&quot;</span>, <span class="at">main=</span><span class="st">&quot;Observed Presence&quot;</span>, <span class="at">col.regions=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">at=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb3-3"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-4" tabindex="-1"></a><span class="co"># Plot the predicted probabilities</span></span>
<span id="cb3-5"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-5" tabindex="-1"></a>pred.grid <span class="ot">&lt;-</span> grid</span>
<span id="cb3-6"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-6" tabindex="-1"></a>pred.grid<span class="sc">$</span>predicted <span class="ot">&lt;-</span> result<span class="sc">$</span>summary.fitted.values<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)]</span>
<span id="cb3-7"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-7" tabindex="-1"></a><span class="fu">spplot</span>(pred.grid, <span class="st">&quot;predicted&quot;</span>, <span class="at">main=</span><span class="st">&quot;Predicted Presence Probability&quot;</span>, <span class="at">col.regions=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>), <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb3-8"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-9" tabindex="-1"></a><span class="co"># Plot the spatial random effect (this captures the spatial structure not explained by the environmental predictor)</span></span>
<span id="cb3-10"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-10" tabindex="-1"></a>spatial.effect <span class="ot">&lt;-</span> result<span class="sc">$</span>summary.random<span class="sc">$</span>f.x[, <span class="st">&quot;mean&quot;</span>]</span>
<span id="cb3-11"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-11" tabindex="-1"></a>matrix.effect <span class="ot">&lt;-</span> <span class="fu">matrix</span>(spatial.effect, <span class="at">nrow=</span><span class="fu">sqrt</span>(<span class="fu">length</span>(spatial.effect)), <span class="at">ncol=</span><span class="fu">sqrt</span>(<span class="fu">length</span>(spatial.effect)))</span>
<span id="cb3-12"><a href="spatial-areal-geostatistical-sdm-antonio-y-maria.html#cb3-12" tabindex="-1"></a><span class="fu">image</span>(matrix.effect, <span class="at">main=</span><span class="st">&quot;Spatial Effect&quot;</span>, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">col=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>))</span></code></pre></div>

<div style="page-break-after: always;"></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-data-data-type-and-maps-virgilio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="preferential-sampling-in-the-context-of-sdm-david.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/chapter05.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Species Distribution Models.pdf", "Species Distribution Models.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
